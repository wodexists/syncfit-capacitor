SyncFit Reliability Layer â€” Minimal Implementation Diff
1ï¸âƒ£ Add Firestore Mirror for Events You Create
ğŸ”§ Firestore Collection:

users/{userId}/events/{eventId}
ğŸ”¹ When You Create an Event in Google Calendar, also do:

import { getFirestore, doc, setDoc } from 'firebase/firestore';

const db = getFirestore();
const eventRef = doc(db, 'users', userId, 'events', googleEvent.id);

await setDoc(eventRef, {
  eventId: googleEvent.id,
  title: googleEvent.summary,
  startTime: googleEvent.start.dateTime,
  endTime: googleEvent.end.dateTime,
  status: 'synced',
  action: 'create',
  lastSyncedAt: new Date().toISOString()
});

ğŸŸ¢ Where to do this: wrap around your existing createEvent() logic.
2ï¸âƒ£ Mark Local Events as 'pending' Before Syncing

When you're about to create a calendar event:

await setDoc(eventRef, {
  eventId: localId, // temporary UUID
  title: localTitle,
  startTime,
  endTime,
  status: 'pending',
  action: 'create'
});

ğŸ” Later, when sync succeeds, update status to synced.
3ï¸âƒ£ Add Retry/Resync Button

This just:

    Refetches recent events from Google Calendar

    Re-attempts any local events marked as pending or error

async function resyncCalendar(userId, accessToken) {
  const eventDocs = await getDocs(collection(db, 'users', userId, 'events'));

  for (const docSnap of eventDocs.docs) {
    const event = docSnap.data();

    if (event.status === 'pending' || event.status === 'error') {
      try {
        const created = await createEventOnGoogleCalendar(accessToken, event);
        await setDoc(doc(db, 'users', userId, 'events', created.id), {
          ...event,
          eventId: created.id,
          status: 'synced',
          lastSyncedAt: new Date().toISOString()
        });
      } catch (e) {
        console.error('Resync failed for event', event.eventId);
      }
    }
  }
}

ğŸŸ¢ Add a tiny â€œResyncâ€ button to call this when needed.
4ï¸âƒ£ (Optional) Conflict Flag

When you pull Google Calendar events, compare them to your Firestore mirror.

If:

    googleEvent.updated !== firestoreEvent.lastSyncedAt

    OR googleEvent.start/end are different

Then mark the Firestore event as:

status: 'conflict'

ğŸŸ¡ You donâ€™t need to resolve this yet â€” just flag for future.
5ï¸âƒ£ Tiny Sync UI Feedback (Non-Blocking)

Somewhere in the UI (e.g., below Explore Workouts or Calendar):

<SyncStatus status={currentSyncStatus} />

function SyncStatus({ status }) {
  if (status === 'syncing') return <p>ğŸ” Syncingâ€¦</p>;
  if (status === 'error') return <p>âš ï¸ Sync failed â€” tap to retry</p>;
  if (status === 'synced') return <p>âœ… Synced</p>;
  return null;
}

